close all;
clear all;
f=1:1:8000;%????
w=2*pi*f;
R=2000;%??? %2200
C=1e-6;%??? %0.47
for m=1:length(f)
    Zc(m)=1/(2*pi*w(m)*C);%????
end
plot(f,Zc);
title('????');
Fc=1/(2*pi*R*C);%????
Para=R*C*i;
for n=1:length(f)
    A(n)=abs(1/(1+Para*w(n)));%??????
    P(n)=angle(1/(1+Para*w(n))) * 180 / pi;%????
end
figure;
subplot(2,1,1);
plot(f,A,'r');%????
title('??????');
subplot(2,1,2);
plot(f,P,'blue');%????
title('????');
%????
Func=tf(1,[R*C,1]);%???????
figure;
subplot(2,1,1);
bode(Func);%??????
title('???');
subplot(2,1,2);
nyquist(Func);%??????
title('???');
%??lsim?????????FFT????
figure;
F1=0.1;
F2=100;
F3=1000;
F4=2000;
F5=300;
%
Fs=10000;%???
N=20000;%????
n=0:N-1;
t=n/Fs;%????
f=n*Fs/N;%????
%
SigIn=sin(2*pi*F1*t)+5*sin(2*pi*F2*t)+10*sin(2*pi*F3*t)+30*sin(2*pi*F4*t)+2*sin(2*pi*F5*t);%????
[SigOut,Tr] = lsim(Func,SigIn,t);%???????
subplot(2,1,1);
plot(t,SigIn);
title('????');
subplot(2,1,2);
plot(Tr,SigOut);
title('??????');
%?????????????
sigInFFT = fft(SigIn,N);%FFT??
%????
sigInAmp = abs(sigInFFT) * 2 / N;
sigInAmp(1) = sigInAmp(1) / 2;
%????
sigInPhase = angle(sigInFFT) * 180 / pi;
figure;
subplot(2,1,1);
plot(f,sigInAmp);
title('????????');
subplot(2,1,2);
plot(f,sigInPhase);
title('????????');
%?????????????
sigOutFFT = fft(SigOut,N);%FFT??
%????
sigOutAmp = abs(sigOutFFT) * 2 / N;
sigOutAmp(1) = sigOutAmp(1) / 2;
%????
sigOutPhase = angle(sigOutFFT) * 180 / pi;
figure;
subplot(2,1,1);
plot(f,sigOutAmp);
title('????????');
subplot(2,1,2);
plot(f,sigOutPhase);
title('????????');